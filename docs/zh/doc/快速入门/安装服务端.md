

# 安装服务端

## 环境准备

Polaris的运行对操作系统没有任何预装运行环境的要求。只需要满足以下操作系统的要求：

1. 64 bit操作系统，支持Linux/Unix

## 获取软件包

可以在Polaris的[release note](https://github.com/polarismesh/polaris/releases)上获取到Polaris的所有版本以及相关介绍。推荐使用最新的稳定版本。

### 下载发行包

你可以从版本页面下载最新的稳定版本软件包

```bash
unzip polaris-server-standalone-release_$version.zip 或者 tar -xvf polaris-server-standalone-release_$version.tar.gz
cd polaris/tool
```


## 安装单机版服务端

注意，单机版仅供本地开发测试使用，如果需要生产使用请安装集群版

### Linux/Unix

#### 全新安装

```bash
bash install-standalone.sh
```

#### 使用已有数据库进行安装

数据库要求：MySQL 5.7及以上

```bash
bash install-standalone.sh -e -i <db_host> -p <db_port> -u <db_user> -w <db_pwd>
```

#### 离线安装

在无法联网或者网络情况比较差的环境下进行安装时，可以选择离线方式进行安装

离线安装需要预先下载2个依赖：
1. MySQL：
下载mysql57-community-release-el7-11.noarch.rpm，点击[链接](https://repo.mysql.com/mysql57-community-release-el7-11.noarch.rpm)进行下载
2. Prometheus
下载prometheus-2.28.0.linux-amd64.tar.gz，点击[链接](https://github.com/prometheus/prometheus/releases/download/v2.28.0/prometheus-2.28.0.linux-amd64.tar.gz)进行下载

下载后需要将压缩包放置在解压后的polaris目录下

## 启动服务端

### Linux/Unix

```bash
bash start.sh
```

## 功能验证

### 服务注册

```bash
curl -XPOST -H'Content-Type:application/json' -d'[{"service":"dummy", "namespace":"Test", "host":"127.0.0.1", "port":12380}]' 'http://127.0.0.1:8090/naming/v1/instances' 
```

### 服务发现

```bash
curl -XGET 'http://127.0.0.1:8090/naming/v1/instances?service=dummy&namespace=Test'
```

### 写入路由规则

```bash
curl -XPOST -H'Content-Type:application/json' -d'[{"service":"dummy", "namespace":"Test", "inbounds":[], "outbounds":[]}]' 'http://127.0.0.1:8090/naming/v1/routings
```

### 获取路由规则

```bash
curl -XGET 'http://127.0.0.1:8090/naming/v1/routings?service=dummy&namespace=Test'
```

## 关闭服务端

### Linux/Unix

```bash
bash stop.sh
```
