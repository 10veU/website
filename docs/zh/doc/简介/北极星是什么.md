# 北极星是什么

北极星是腾讯开源的服务发现和治理中心，致力于解决分布式或者微服务架构中的服务可见、故障容错、流量控制和安全问题。虽然，业界已经有些组件可以解决其中一部分问题，但是缺少一个标准的、多语言的、框架无关的实现。

腾讯具有海量的分布式服务，加上业务线和技术栈的多样性，沉淀了大大小小数十个相关组件。从 2019 年开始，我们通过北极星对这些组件进行抽象和整合，打造公司统一的服务发现和治理方案，帮助业务提升研发效率和运营质量。

目前，北极星在腾讯内部的服务注册数量超过百万，日接口调用量超过十万亿，通用性和稳定性都得到了大规模的验证。因此，我们将其贡献到开源社区，希望对其他企业有所帮助，也希望吸引更多开发者参与共建。下面从三个方面介绍北极星。

## 北极星解决哪些问题

在分布式服务调用的过程中，业务可能面临以下四类问题。北极星以服务为中心，提供一站式解决方案。

| 问题类型 | 问题示例                                                     | 解决方案 |
| -------- | ------------------------------------------------------------ | -------- |
| 服务可见 | 主调方如何知道被调方的服务地址                               | 注册发现 |
| 故障容错 | 当被调方的部分实例异常时，如何屏蔽异常实例，屏蔽之后如何恢复 | 熔断降级 |
|          | 当某些主调方的请求量过多时，如何限制这些主调方的请求，避免影响其他主调方的请求 | 访问限流 |
| 流量控制 | 被调方包含多个实例，主调方如何确定请求发送到哪个实例，如何保证请求均衡 | 负载均衡 |
|          | 如何实现按地域就近、单元化隔离、金丝雀发布等各种请求调度策略 | 动态路由 |
| 动态配置 | 如何实现服务配置的版本管理、动态下发、按需变更。             | 配置管理 |

## 北极星具备哪些功能

![功能特性](./图片/北极星是什么/功能特性n.png)

北极星主要提供以下核心功能，各部分功能都是基于插件化设计，可单独使用：

- 服务注册发现及服务健康检查

  以服务为中心的分布式应用架构，通过服务和注册发现的方式维护不断变化的请求地址，提高应用的扩展能力，降低应用的迁移成本。北极星提供对注册上来的服务实例进行健康检查，阻止主调方对不健康的服务实例发送请求，同时也提供了保护能力，实例剔除超过一定数量则停止剔除，防止因不健康实例过多导致雪崩效应。

- 路由和负载均衡
  
  根据请求标签、实例标签和标签匹配规则，对线上流量进行动态调度，可以应用于按地域就近、单元化隔离和金丝雀发布等多种场景。

- 熔断降级和限流
  
  提供熔断功能，根据实时采集的错误率等指标，及时熔断异常的服务、接口、实例或者实例分组，降低请求失败率。
  当负载已经超过了系统的最大处理能力时，北极星提供服务限流功能，可针对不同的请求来源和系统资源进行访问限流，避免服务被压垮。
  
- 可观测性
  
  提供服务治理可视化监控视图，支持请求量、请求延时和请求成功率的指标查询，支持服务调用关系和多维度的流量曲线查询，实现服务治理功能和流量观测一体化。
  
- 配置管理
      
  提供配置管理的功能，支持应用配置、公共配置的订阅发布、版本管理、变更通知，实现应用配置动态生效。
  
## 北极星包含哪些组件

![系统组件](./图片/北极星是什么/系统组件.png)

北极星系统组件分为核心组件和生态组件两类：

- 核心组件：控制台、控制面和数据面
- 生态组件：对接常用的开源框架和网关，对接 kubernetes

数据面支持高性能 SDK 和无侵入 Sidecar，两种模式可以互相调用：

- SDK：不劫持业务请求，几乎不增加请求延时，CPU 消耗低，不需要部署和运维 Sidecar
- Sidecar：劫持业务请求，有一定的请求延时，CPU 消耗较高，适用于无侵入的开发场景

北极星兼容常用的开源框架、网关和 kubernetes：

- 支持 grpc 等框架和北极星 SDK 的集成，框架用户不需要直接使用北极星 SDK
- 支持 nginx 等网关和北极星 SDK 的集成，支持网关将请求转发到北极星服务
- 支持 k8s service 自动注册到北极星，实现 k8s service 和框架服务的统一管理
